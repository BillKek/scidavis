--- a/qwtplot3d/include/qwt3d_global.h
+++ b/qwtplot3d/include/qwt3d_global.h
@@ -14,7 +14,7 @@
 // Create Qwt3d DLL if QWT3D_DLL is defined (Windows only)
 //
 
-#if defined(Q_WS_WIN)
+#if defined(Q_OS_WIN)
   #if defined(_MSC_VER) /* MSVC Compiler */
     #pragma warning(disable: 4251) // dll interface required for stl templates
 	   //pragma warning(disable: 4244) // 'conversion' conversion from 'type1' to 'type2', possible loss of data
--- a/qwtplot3d/include/qwt3d_openglhelper.h
+++ b/qwtplot3d/include/qwt3d_openglhelper.h
@@ -5,6 +5,7 @@
 #if QT_VERSION < 0x040000
 #include <qgl.h>
 #else
+#include <GL/glu.h>
 #include <QtOpenGL/qgl.h>
 #endif
 
--- a/qwtplot3d/include/qwt3d_types.h
+++ b/qwtplot3d/include/qwt3d_types.h
@@ -13,7 +13,7 @@
 
 #include "qwt3d_global.h"
 
-#if defined(Q_WS_WIN)
+#if defined(Q_OS_WIN)
 	#include <windows.h>
 #endif
 
--- a/qwtplot3d/src/qwt3d_io_gl2ps.cpp
+++ b/qwtplot3d/src/qwt3d_io_gl2ps.cpp
@@ -3,7 +3,6 @@
 #endif
 
 #include <time.h>
-#include "qwt3d_openglhelper.h"
 #include "../3rdparty/gl2ps/gl2ps.h"
 #include "qwt3d_io_gl2ps.h"
 #include "qwt3d_plot.h"
